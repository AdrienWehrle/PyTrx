
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>PyTrx.Images &#8212; PyTrx 1.1.0 documentation</title>
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">PyTrx 1.1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for PyTrx.Images</h1><div class="highlight"><pre>
<span></span><span class="c1">#PyTrx (c) by Penelope How, Nick Hulton, Lynne Buie</span>
<span class="c1">#</span>
<span class="c1">#PyTrx is licensed under a MIT License.</span>
<span class="c1">#</span>
<span class="c1">#You should have received a copy of the license along with this</span>
<span class="c1">#work. If not, see &lt;https://choosealicense.com/licenses/mit/&gt;.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">The Images module contains the object-constructors and functions for: (1) </span>
<span class="sd">Importing and handling image data, specifically RBG, one-band (R, B or G), and </span>
<span class="sd">grayscale images; and (2) Handling image sequences (i.e. a set of multiple </span>
<span class="sd">images).</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c1">#Import packages</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="k">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">Image</span> 
<span class="kn">from</span> <span class="nn">PIL.ExifTags</span> <span class="k">import</span> <span class="n">TAGS</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">pylab</span> <span class="k">import</span> <span class="n">array</span><span class="p">,</span> <span class="n">uint8</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="k">import</span> <span class="n">reduce</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">imghdr</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">cv2</span>

<span class="c1">#------------------------------------------------------------------------------</span>

<div class="viewcode-block" id="CamImage"><a class="viewcode-back" href="../../Modules.html#PyTrx.Images.CamImage">[docs]</a><span class="k">class</span> <span class="nc">CamImage</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>    
    <span class="sd">&quot;&quot;&quot;A class representing a raw single band (optical RGB or greyscale). This </span>
<span class="sd">    CamImage object is used in subsequent timelapse analysis. The object </span>
<span class="sd">    contains the image data, image path, image dimensions and timestamp </span>
<span class="sd">    (derived from the image Exif data, if available).       </span>
<span class="sd">    Optionally the user can specify whether the red, blue or green values </span>
<span class="sd">    should be used, or whether the images should be converted to grey scale </span>
<span class="sd">    which is the default. No image calibration is undertaken at this point.</span>
<span class="sd">    The default grayscale band option (&#39;l&#39;) applies an equalization filter </span>
<span class="sd">    on the image whereas the RGB splits are raw RGB. This could be modified </span>
<span class="sd">    to permit more sophisticated settings of RGB combinations and/or </span>
<span class="sd">    filters with file reading.</span>
<span class="sd">    </span>
<span class="sd">    :param imagePath: The file path to a given image</span>
<span class="sd">    :type imagePath: str</span>
<span class="sd">    :param band: Specified image band to pass forward: &#39;r&#39; - red band; &#39;b&#39; - blue band; &#39;g&#39; - green band; and &#39;l&#39; - grayscale. Default to &#39;l&#39;</span>
<span class="sd">    :type band: str</span>
<span class="sd">    :param equal: Flag denoting whether histogram equalisation is applied to images (histogram equalisation is applied if True). Default to True</span>
<span class="sd">    :type equal: bool, optional</span>
<span class="sd">    &quot;&quot;&quot;</span>   
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">imagePath</span><span class="p">,</span> <span class="n">band</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;CamImage constructor to set image path, read in image data in the </span>
<span class="sd">        specified band and access Exif data.         </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1">#Define class properties</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_imageGood</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_band</span> <span class="o">=</span> <span class="n">band</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_equal</span> <span class="o">=</span> <span class="n">equal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_imageArray</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_image</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_imsize</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_timestamp</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_impath</span> <span class="o">=</span> <span class="n">imagePath</span>
        
        <span class="c1">#Check image file path</span>
        <span class="n">success</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_checkImage</span><span class="p">(</span><span class="n">imagePath</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_imageGood</span><span class="o">=</span><span class="kc">False</span>
            <span class="k">return</span>

                    
<div class="viewcode-block" id="CamImage.imageGood"><a class="viewcode-back" href="../../Modules.html#PyTrx.Images.CamImage.imageGood">[docs]</a>    <span class="k">def</span> <span class="nf">imageGood</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return image file path status.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_imageGood</span></div>

        
<div class="viewcode-block" id="CamImage.clearImage"><a class="viewcode-back" href="../../Modules.html#PyTrx.Images.CamImage.clearImage">[docs]</a>    <span class="k">def</span> <span class="nf">clearImage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clear memory of image data.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_image</span><span class="o">=</span><span class="kc">None</span></div>


<div class="viewcode-block" id="CamImage.clearImageArray"><a class="viewcode-back" href="../../Modules.html#PyTrx.Images.CamImage.clearImageArray">[docs]</a>    <span class="k">def</span> <span class="nf">clearImageArray</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clear memory of image array data.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_imageArray</span><span class="o">=</span><span class="kc">None</span>     </div>

        
<div class="viewcode-block" id="CamImage.clearAll"><a class="viewcode-back" href="../../Modules.html#PyTrx.Images.CamImage.clearAll">[docs]</a>    <span class="k">def</span> <span class="nf">clearAll</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clear memory of all retained data.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_image</span><span class="o">=</span><span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_imageArray</span><span class="o">=</span><span class="kc">None</span>      </div>

     
    <span class="k">def</span> <span class="nf">_checkImage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Check that the given image file path is correct.&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Checking image file &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
        
        <span class="c1">#Check file path using os package</span>
        <span class="n">exists</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> 
        <span class="k">if</span> <span class="n">exists</span><span class="p">:</span>
            
            <span class="c1">#Check file type</span>
            <span class="n">ftype</span><span class="o">=</span><span class="n">imghdr</span><span class="o">.</span><span class="n">what</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ftype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;File exists but not image type: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ftype</span><span class="p">))</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;File found of image type: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ftype</span><span class="p">))</span>
                <span class="k">return</span> <span class="kc">True</span>

        <span class="k">else</span><span class="p">:</span>           
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;File does not exist: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
            <span class="k">return</span> <span class="kc">False</span>

        
<div class="viewcode-block" id="CamImage.getImageType"><a class="viewcode-back" href="../../Modules.html#PyTrx.Images.CamImage.getImageType">[docs]</a>    <span class="k">def</span> <span class="nf">getImageType</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the image file type.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">imghdr</span><span class="o">.</span><span class="n">what</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_impath</span><span class="p">)</span>        </div>


<div class="viewcode-block" id="CamImage.getImagePath"><a class="viewcode-back" href="../../Modules.html#PyTrx.Images.CamImage.getImagePath">[docs]</a>    <span class="k">def</span> <span class="nf">getImagePath</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the file path of the image.&quot;&quot;&quot;</span>        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_impath</span></div>


<div class="viewcode-block" id="CamImage.getImageName"><a class="viewcode-back" href="../../Modules.html#PyTrx.Images.CamImage.getImageName">[docs]</a>    <span class="k">def</span> <span class="nf">getImageName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return image name.&quot;&quot;&quot;</span>
        <span class="n">imn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getImagePath</span><span class="p">()</span>
        <span class="n">imn</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">imn</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">imn</span><span class="o">.</span><span class="n">name</span>   </div>


<div class="viewcode-block" id="CamImage.getImage"><a class="viewcode-back" href="../../Modules.html#PyTrx.Images.CamImage.getImage">[docs]</a>    <span class="k">def</span> <span class="nf">getImage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the image.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_image</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_readImage</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_image</span></div>

    
<div class="viewcode-block" id="CamImage.getImageCorr"><a class="viewcode-back" href="../../Modules.html#PyTrx.Images.CamImage.getImageCorr">[docs]</a>    <span class="k">def</span> <span class="nf">getImageCorr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cameraMatrix</span><span class="p">,</span> <span class="n">distortP</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the image array that is corrected for the specificied </span>
<span class="sd">        camera matrix and distortion parameters.</span>
<span class="sd">        </span>
<span class="sd">        :param cameraMatrix: Intrinsic camera matrix</span>
<span class="sd">        :type cameraMatrix: arr</span>
<span class="sd">        :param distortP: Lens distortion parameters</span>
<span class="sd">        :type distortP: arr</span>
<span class="sd">        :returns: Image corrected for image distortion (arr)</span>
<span class="sd">        :rtype: arr</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#Get image array        </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_imageArray</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_readImageData</span><span class="p">()</span>
            
        <span class="n">size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getImageSize</span><span class="p">()</span>      
        
        <span class="c1">#Calculate optimal camera matrix </span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">newMat</span><span class="p">,</span> <span class="n">roi</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">getOptimalNewCameraMatrix</span><span class="p">(</span><span class="n">cameraMatrix</span><span class="p">,</span> 
                                                    <span class="n">distortP</span><span class="p">,</span> 
                                                    <span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">h</span><span class="p">),</span> 
                                                    <span class="mi">1</span><span class="p">,</span> 
                                                    <span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">h</span><span class="p">))</span>
        <span class="c1">#Correct image for distortion                                                </span>
        <span class="n">corr_image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">undistort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_imageArray</span><span class="p">,</span> 
                                   <span class="n">cameraMatrix</span><span class="p">,</span> 
                                   <span class="n">distortP</span><span class="p">,</span> 
                                   <span class="n">newCameraMatrix</span><span class="o">=</span><span class="n">newMat</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">corr_image</span></div>

        
<div class="viewcode-block" id="CamImage.getImageArray"><a class="viewcode-back" href="../../Modules.html#PyTrx.Images.CamImage.getImageArray">[docs]</a>    <span class="k">def</span> <span class="nf">getImageArray</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the image as an array.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_imageArray</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_readImageData</span><span class="p">()</span>   
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_imageArray</span></div>
 

<div class="viewcode-block" id="CamImage.getImageEnhance"><a class="viewcode-back" href="../../Modules.html#PyTrx.Images.CamImage.getImageEnhance">[docs]</a>    <span class="k">def</span> <span class="nf">getImageEnhance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">diff</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return enhanced image using :func:`PyTrx.Images.enhanceImg` function.</span>

<span class="sd">        :param diff: Inputted as either &#39;light or &#39;dark&#39;, signifying the intensity of the image pixels. &#39;light&#39; increases the intensity such that dark pixels become much brighter and bright pixels become slightly brighter. &#39;dark&#39; decreases the intensity such that dark pixels become much darker and bright pixels become slightly darker.</span>
<span class="sd">        :type diff: str</span>
<span class="sd">        :param phi: Defines the intensity of all pixel values</span>
<span class="sd">        :type phi: int</span>
<span class="sd">        :param theta: Defines the number of &quot;colours&quot; in the image, e.g. 3 signifies that all the pixels will be grouped into one of three pixel values</span>
<span class="sd">        :type theta: int         </span>
<span class="sd">        :returns: Enhanced image</span>
<span class="sd">        :rtype: arr</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getImageArray</span><span class="p">()</span>
        <span class="n">image1</span> <span class="o">=</span> <span class="n">enhanceImage</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">diff</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">image1</span></div>

       
<div class="viewcode-block" id="CamImage.getImageSize"><a class="viewcode-back" href="../../Modules.html#PyTrx.Images.CamImage.getImageSize">[docs]</a>    <span class="k">def</span> <span class="nf">getImageSize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the size of the image (which is obtained from the image Exif </span>
<span class="sd">        information).&quot;&quot;&quot;</span>        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_imsize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_imsize</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_timestamp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getExif</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_imsize</span></div>

        
<div class="viewcode-block" id="CamImage.getImageTime"><a class="viewcode-back" href="../../Modules.html#PyTrx.Images.CamImage.getImageTime">[docs]</a>    <span class="k">def</span> <span class="nf">getImageTime</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the time of the image (which is obtained from the image Exif</span>
<span class="sd">        information).&quot;&quot;&quot;</span>       
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timestamp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_imsize</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_timestamp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getExif</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_timestamp</span></div>
 
       
<div class="viewcode-block" id="CamImage.getExif"><a class="viewcode-back" href="../../Modules.html#PyTrx.Images.CamImage.getExif">[docs]</a>    <span class="k">def</span> <span class="nf">getExif</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the exif image size and time stamp data from the image. Image</span>
<span class="sd">        size is returned as a string (height, width). The time stamp is</span>
<span class="sd">        returned as a Python datetime object.&quot;&quot;&quot;</span>
        <span class="c1">#Get the Exif data</span>
        <span class="n">exif</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_image</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_image</span><span class="o">=</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_impath</span><span class="p">)</span>
        
        <span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_image</span><span class="o">.</span><span class="n">_getexif</span><span class="p">()</span>
        
        <span class="c1">#Put each item into the Exif dictionary</span>
        <span class="k">for</span> <span class="n">tag</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">info</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">decoded</span> <span class="o">=</span> <span class="n">TAGS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>
            <span class="n">exif</span><span class="p">[</span><span class="n">decoded</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>            
        <span class="n">imsize</span><span class="o">=</span><span class="p">[</span><span class="n">exif</span><span class="p">[</span><span class="s1">&#39;ExifImageHeight&#39;</span><span class="p">],</span> <span class="n">exif</span><span class="p">[</span><span class="s1">&#39;ExifImageWidth&#39;</span><span class="p">]]</span>
        
        <span class="c1">#Construct datetime object from Exif string</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">timestr</span> <span class="o">=</span> <span class="n">exif</span><span class="p">[</span><span class="s1">&#39;DateTime&#39;</span><span class="p">]</span>
            <span class="n">items</span><span class="o">=</span><span class="n">timestr</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="n">date</span><span class="o">=</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
            <span class="n">time</span><span class="o">=</span><span class="n">items</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
            <span class="n">timestamp</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">date</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">date</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">date</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                               <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Unable to get valid timestamp for image file: &#39;</span>
                   <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_impath</span><span class="p">)</span>
            <span class="n">timestamp</span><span class="o">=</span><span class="kc">None</span>
            
        <span class="k">return</span> <span class="n">imsize</span><span class="p">,</span> <span class="n">timestamp</span>      </div>

        
<div class="viewcode-block" id="CamImage.changeBand"><a class="viewcode-back" href="../../Modules.html#PyTrx.Images.CamImage.changeBand">[docs]</a>    <span class="k">def</span> <span class="nf">changeBand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">band</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Change the band you want the image to represent (&#39;r&#39;, &#39;b&#39;, &#39;g&#39; or &#39;l&#39;)</span>
<span class="sd">        </span>
<span class="sd">        :param band: Image band (&#39;r&#39;, &#39;b&#39;, &#39;g&#39;, or &#39;l&#39;)</span>
<span class="sd">        :type band: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_band</span><span class="o">=</span><span class="n">band</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_readImageData</span><span class="p">()</span></div>
        
        
<div class="viewcode-block" id="CamImage.reportCamImageData"><a class="viewcode-back" href="../../Modules.html#PyTrx.Images.CamImage.reportCamImageData">[docs]</a>    <span class="k">def</span> <span class="nf">reportCamImageData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Report image data (file path, image size and datetime).&quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Image source path: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getImagePath</span><span class="p">()))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Image size: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getImageSize</span><span class="p">()))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Image datetime: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getImageTime</span><span class="p">()))</span></div>

        
    <span class="k">def</span> <span class="nf">_readImage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read image from file path using PIL.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_image</span><span class="o">=</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_impath</span><span class="p">)</span>
    
    
    <span class="k">def</span> <span class="nf">_readImageData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function to prepare an image by opening, equalising, converting to </span>
<span class="sd">        a desired band or grayscale, then returning a copy.&quot;&quot;&quot;</span>               
        <span class="c1">#Open image from file using PIL        </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_image</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_impath</span><span class="p">)</span>
        
        <span class="n">img</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_image</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_equal</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            
            <span class="c1">#Apply histogram equalisation</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">histogram</span><span class="p">()</span>
            <span class="n">lut</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">),</span> <span class="mi">256</span><span class="p">):</span>
                <span class="c1"># step size</span>
                <span class="n">step</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="n">h</span><span class="p">[</span><span class="n">b</span><span class="p">:</span><span class="n">b</span><span class="o">+</span><span class="mi">256</span><span class="p">])</span> <span class="o">/</span> <span class="mi">255</span>
                <span class="c1"># create equalization lookup table</span>
                <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
                    <span class="n">lut</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span> <span class="o">/</span> <span class="n">step</span><span class="p">)</span>
                    <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">b</span><span class="p">]</span>
            
            <span class="c1">#Convert to grayscale or desired band</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">point</span><span class="p">(</span><span class="n">lut</span><span class="o">*</span><span class="n">img</span><span class="o">.</span><span class="n">layers</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_band</span> <span class="o">==</span> <span class="s1">&#39;R&#39;</span><span class="p">:</span>
            <span class="n">img</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_band</span> <span class="o">==</span> <span class="s1">&#39;G&#39;</span><span class="p">:</span>
            <span class="n">r</span><span class="p">,</span><span class="n">img</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> 
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_band</span> <span class="o">==</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span>
            <span class="n">r</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> 
        <span class="k">else</span><span class="p">:</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">)</span>
        
        <span class="c1">#Copy image array</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_imageArray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">img</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></div>
                

<span class="c1">#------------------------------------------------------------------------------</span>
        
<div class="viewcode-block" id="ImageSequence"><a class="viewcode-back" href="../../Modules.html#PyTrx.Images.ImageSequence">[docs]</a><span class="k">class</span> <span class="nc">ImageSequence</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A class to model a raw collection of CamImage objects, which can </span>
<span class="sd">    subsequently be used for making photogrammetric measurements from.</span>
<span class="sd">      </span>
<span class="sd">    :param imageList: The list of images, which can be passed in 3 ways: 1) As a list of :class:`PyTrx.Image.CamImage` objects; 2) As a list of image paths; and 3) As a folder containing images</span>
<span class="sd">    :type imageList: str</span>
<span class="sd">    :param band: Image band (&#39;r&#39;, &#39;b&#39;, &#39;g&#39;, or &#39;l&#39;), default to &#39;l&#39;</span>
<span class="sd">    :type band: str, optional</span>
<span class="sd">    :param equal: Flag denoting whether histogram equalisation is applied to images (histogram equalisation is applied if True). Default to True</span>
<span class="sd">    :type equal: bool, optional</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">imageList</span><span class="p">,</span> <span class="n">band</span><span class="o">=</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">CONSTRUCTING IMAGE SEQUENCE&#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_band</span><span class="o">=</span><span class="n">band</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_equal</span><span class="o">=</span><span class="n">equal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_imageList</span><span class="o">=</span><span class="n">imageList</span>
        
        <span class="c1">#Construct image set (as CamImage objects)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">imageList</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span> 
            
            <span class="c1">#Construction from list of CamImage objects</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">imageList</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">CamImage</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">List of camera images assumed in image sequence&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Attempting to add all to sequence&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_imageSet</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">CamImage</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_imageSet</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Warning non-image item found in image set&#39;</span> 
                              <span class="s1">&#39; list specification - item not added&#39;</span><span class="p">)</span>
                <span class="k">return</span>
                
            <span class="c1">#Construction from list containing file name strings                </span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">imageList</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">str</span><span class="p">):</span>               
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">List of camera images assumed of image sequence&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Attempting to add all to sequence&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_loadImageStringSequence</span><span class="p">(</span><span class="n">imageList</span><span class="p">)</span>
                
            <span class="k">else</span><span class="p">:</span>                
                <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">List item type used to define image list neither&#39;</span> 
                           <span class="s1">&#39; image nor strings (filenames)&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">None</span>
        
        <span class="c1">#Construction from string of file paths</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">imageList</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Image directory path assumed. Searching for images.&#39;</span> <span class="o">+</span> 
                  <span class="s1">&#39; Attempting to add all to sequence&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">imageList</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_imageList</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">imageList</span><span class="p">))</span>
<span class="c1">#                                     key=os.path.getmtime)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_loadImageStringSequence</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_imageList</span><span class="p">)</span>
            
            
<div class="viewcode-block" id="ImageSequence.getImageArrNo"><a class="viewcode-back" href="../../Modules.html#PyTrx.Images.ImageSequence.getImageArrNo">[docs]</a>    <span class="k">def</span> <span class="nf">getImageArrNo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get image array i from image sequence</span>
<span class="sd">        </span>
<span class="sd">        :param i: Image number in sequence</span>
<span class="sd">        :type i: int</span>
<span class="sd">        :returns: Image array</span>
<span class="sd">        :rtype: arr</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">im</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_imageSet</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">arr</span><span class="o">=</span><span class="n">im</span><span class="o">.</span><span class="n">getImageArray</span><span class="p">()</span>
        <span class="n">im</span><span class="o">.</span><span class="n">clearAll</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">arr</span></div>

    
<div class="viewcode-block" id="ImageSequence.getImageObj"><a class="viewcode-back" href="../../Modules.html#PyTrx.Images.ImageSequence.getImageObj">[docs]</a>    <span class="k">def</span> <span class="nf">getImageObj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get :class:`PyTrx.Images.CamImage` object i from image sequence</span>
<span class="sd">        </span>
<span class="sd">        :param i: Image number in sequence</span>
<span class="sd">        :type i: int</span>
<span class="sd">        :returns: :class:`PyTrx.Images.CamImage` </span>
<span class="sd">        :rtype: arr</span>
<span class="sd">	    &quot;&quot;&quot;</span>
        <span class="n">imo</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_imageSet</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> 
        <span class="k">return</span> <span class="n">imo</span></div>

        
    <span class="k">def</span> <span class="nf">_loadImageStringSequence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">imageList</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Function for generating an image set (of :class:`PyTrx.Images.CamImage`</span>
<span class="sd">        objects) from a list of images.&quot;&quot;&quot;</span>      
        <span class="c1">#Construct CamImage objects</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_imageSet</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">imageStr</span> <span class="ow">in</span> <span class="n">imageList</span><span class="p">:</span>
            <span class="n">im</span><span class="o">=</span><span class="n">CamImage</span><span class="p">(</span><span class="n">imageStr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_band</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_equal</span><span class="p">)</span>
            
            <span class="c1">#Append image filepath if filepath is true</span>
            <span class="k">if</span> <span class="n">im</span><span class="o">.</span><span class="n">imageGood</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_imageSet</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
                    
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Problem reading image: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">imageStr</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Image: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">imageStr</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; not added to sequence&#39;</span><span class="p">)</span>

                
<div class="viewcode-block" id="ImageSequence.getImages"><a class="viewcode-back" href="../../Modules.html#PyTrx.Images.ImageSequence.getImages">[docs]</a>    <span class="k">def</span> <span class="nf">getImages</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return image set (i.e. a sequence of CamImage objects).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_imageSet</span></div>

        
<div class="viewcode-block" id="ImageSequence.getImageFileList"><a class="viewcode-back" href="../../Modules.html#PyTrx.Images.ImageSequence.getImageFileList">[docs]</a>    <span class="k">def</span> <span class="nf">getImageFileList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return list of image file paths.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_imageList</span></div>


<div class="viewcode-block" id="ImageSequence.getImageNames"><a class="viewcode-back" href="../../Modules.html#PyTrx.Images.ImageSequence.getImageNames">[docs]</a>    <span class="k">def</span> <span class="nf">getImageNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return list of image file names.&quot;&quot;&quot;</span>
        <span class="n">imgf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getImageFileList</span><span class="p">()</span>
        <span class="n">imns</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">imgf</span><span class="p">:</span>
            <span class="n">imn</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">imns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">imn</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">imns</span></div>

        
<div class="viewcode-block" id="ImageSequence.getLength"><a class="viewcode-back" href="../../Modules.html#PyTrx.Images.ImageSequence.getLength">[docs]</a>    <span class="k">def</span> <span class="nf">getLength</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return length of image set.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_imageSet</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="enhanceImage"><a class="viewcode-back" href="../../Modules.html#PyTrx.Images.enhanceImage">[docs]</a><span class="k">def</span> <span class="nf">enhanceImage</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">diff</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Change brightness and contrast of image using phi and theta variables. </span>
<span class="sd">    Change phi and theta values accordingly.</span>
<span class="sd">    </span>
<span class="sd">    :param img: Input image array for enhancement</span>
<span class="sd">    :type img: arr</span>
<span class="sd">    :param diff: Inputted as either &#39;light or &#39;dark&#39;, signifying the intensity of the image pixels. &#39;light&#39; increases the intensity such that dark pixels become much brighter and bright pixels become slightly brighter. &#39;dark&#39; decreases the intensity such that dark pixels become much darker and bright pixels become slightly darker.</span>
<span class="sd">    :type diff: str</span>
<span class="sd">    :param phi: Defines the intensity of all pixel values</span>
<span class="sd">    :type phi: int</span>
<span class="sd">    :param theta: Defines the number of &quot;colours&quot; in the image, e.g. 3 signifies that all the pixels will be grouped into one of three pixel values</span>
<span class="sd">    :type theta: int               .</span>
<span class="sd">    :returns: Enhanced image.</span>
<span class="sd">    :rtype: arr</span>
<span class="sd">    &quot;&quot;&quot;</span>                          
    <span class="c1">#Define maximum pixel intensity</span>
    <span class="n">maxIntensity</span> <span class="o">=</span> <span class="mf">255.0</span> <span class="c1">#depends on dtype of image data </span>
    
    <span class="c1">#If diff variable is light</span>
    <span class="k">if</span> <span class="n">diff</span> <span class="o">==</span> <span class="s1">&#39;light&#39;</span><span class="p">:</span>        

        <span class="c1">#Increase intensity such that dark pixels become much brighter</span>
        <span class="c1">#and bright pixels become slightly brighter</span>
        <span class="n">img1</span> <span class="o">=</span> <span class="p">(</span><span class="n">maxIntensity</span><span class="o">/</span><span class="n">phi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">img</span><span class="o">/</span><span class="p">(</span><span class="n">maxIntensity</span><span class="o">/</span><span class="n">theta</span><span class="p">))</span><span class="o">**</span><span class="mf">0.5</span>
        <span class="n">img1</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">uint8</span><span class="p">)</span>
    
    <span class="c1">#If diff variable is dark</span>
    <span class="k">elif</span> <span class="n">diff</span> <span class="o">==</span> <span class="s1">&#39;dark&#39;</span><span class="p">:</span>        

        <span class="c1">#Decrease intensity such that dark pixels become much darker and </span>
        <span class="c1">#bright pixels become slightly darker          </span>
        <span class="n">img1</span> <span class="o">=</span> <span class="p">(</span><span class="n">maxIntensity</span><span class="o">/</span><span class="n">phi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">img</span><span class="o">/</span><span class="p">(</span><span class="n">maxIntensity</span><span class="o">/</span><span class="n">theta</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">img1</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">uint8</span><span class="p">)</span>
    
    <span class="c1">#If diff variable not assigned then reassign to light</span>
    <span class="k">else</span><span class="p">:</span>          
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Invalid diff variable&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Re-assigning diff variable to &quot;light&quot;&#39;</span><span class="p">)</span>
        <span class="n">img1</span> <span class="o">=</span> <span class="p">(</span><span class="n">maxIntensity</span><span class="o">/</span><span class="n">phi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">img</span><span class="o">/</span><span class="p">(</span><span class="n">maxIntensity</span><span class="o">/</span><span class="n">theta</span><span class="p">))</span><span class="o">**</span><span class="mf">0.5</span>
        <span class="n">img1</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">img1</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">uint8</span><span class="p">)</span>
    
    <span class="c1">#Return enhanced image</span>
    <span class="k">return</span> <span class="n">img1</span></div>


<span class="c1">#------------------------------------------------------------------------------</span>

<span class="c1">#if __name__ == &quot;__main__&quot;:   </span>
<span class="c1">#    print &#39;\nProgram finished&#39;        </span>

<span class="c1">#------------------------------------------------------------------------------</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">PyTrx 1.1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Penelope How, Nick Hulton, Lynne Buie.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.0.
    </div>
  </body>
</html>